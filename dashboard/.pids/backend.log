INFO:     Started server process [3044]
INFO:     Waiting for application startup.
2025-11-01 20:28:25,929 - backend - INFO - Starting FastAPI application...
2025-11-01 20:28:25,938 - backend - INFO - Loading metadata from /Users/barry/Desktop/CS/25S2/5339/assignment02_1107/data/csv_output/facilities.csv, found 515 facilities
2025-11-01 20:28:25,949 - backend - INFO - Loaded metadata for 515 facilities
2025-11-01 20:28:25,949 - backend - INFO - Metadata loader initialized
2025-11-01 20:28:25,949 - backend - INFO - Data processor initialized
2025-11-01 20:28:25,949 - backend - INFO - Market data processor initialized
2025-11-01 20:28:26,258 - backend - INFO - MQTT subscriber started
2025-11-01 20:28:26,258 - backend - INFO - Facility MQTT subscriber started
2025-11-01 20:28:26,545 - backend - INFO - MQTT subscriber started
2025-11-01 20:28:26,545 - backend - INFO - Market MQTT subscriber started
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-11-01 20:28:26,826 - backend - INFO - Connected to MQTT broker broker.hivemq.com:1883
2025-11-01 20:28:26,826 - backend - INFO - Subscribed to topic: a02/market_metrics/v1/stream
2025-11-01 20:28:29,175 - backend - INFO - Connected to MQTT broker broker.hivemq.com:1883
2025-11-01 20:28:29,176 - backend - INFO - Subscribed to topic: a02/facility_metrics/v1/stream
INFO:     ('127.0.0.1', 52082) - "WebSocket /ws/realtime" [accepted]
2025-11-01 20:28:30,506 - backend - INFO - WebSocket client connected. Total connections: 1
INFO:     connection open
INFO:     ('127.0.0.1', 52084) - "WebSocket /ws/realtime" [accepted]
2025-11-01 20:28:30,894 - backend - INFO - WebSocket client connected. Total connections: 2
INFO:     connection open
INFO:     127.0.0.1:52087 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:52087 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     Shutting down
2025-11-01 20:29:31,173 - backend - INFO - WebSocket client disconnected. Total connections: 1
2025-11-01 20:29:31,173 - backend - INFO - WebSocket client disconnected. Total connections: 0
INFO:     connection closed
INFO:     connection closed
INFO:     Waiting for application shutdown.
2025-11-01 20:29:31,276 - backend - INFO - Shutting down FastAPI application...
2025-11-01 20:29:31,743 - backend - WARNING - Disconnected from MQTT broker, rc=0
2025-11-01 20:29:31,744 - backend - INFO - MQTT subscriber stopped
2025-11-01 20:29:31,744 - backend - INFO - Market MQTT subscriber stopped
2025-11-01 20:29:32,461 - backend - WARNING - Disconnected from MQTT broker, rc=0
2025-11-01 20:29:32,462 - backend - INFO - MQTT subscriber stopped
2025-11-01 20:29:32,462 - backend - INFO - Facility MQTT subscriber stopped
INFO:     Application shutdown complete.
INFO:     Finished server process [3044]
